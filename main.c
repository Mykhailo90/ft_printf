/* ************************************************************************** *//*                                                                            *//*                                                        :::      ::::::::   *//*   main.c                                             :+:      :+:    :+:   *//*                                                    +:+ +:+         +:+     *//*   By: msarapii <marvin@42.fr>                    +#+  +:+       +#+        *//*                                                +#+#+#+#+#+   +#+           *//*   Created: 2018/01/30 16:34:49 by msarapii          #+#    #+#             *//*   Updated: 2018/01/30 16:34:51 by msarapii         ###   ########.fr       *//*                                                                            *//* ************************************************************************** */ #include "ft_printf.h"void set_list_null(t_list *com){	com->size = NULL;	com->precision = NULL;	com->width = NULL;	com->flags = NULL;}int		input_symb(char *str, char ch){	int	i;		i = 0;	while (str[i] != '\0')	{		if (str[i] == ch)			return (1);		i++;	}	return (0);}char	*search_sp_d(va_list argptr, t_list *com){	char *res_str;	res_str = NULL;	if (com->size == NULL)		res_str = ft_itoa(va_arg(argptr, int));	else if (input_symb(com->size, 'z'))		res_str = ft_itoa((size_t)va_arg(argptr, size_t));	else if (input_symb(com->size, 't'))		res_str = ft_itoa((ptrdiff_t)va_arg(argptr, ptrdiff_t));	else if (input_symb(com->size, 'j'))		res_str = ft_itoa((intmax_t)va_arg(argptr, intmax_t));	else if (input_symb(com->size, '2'))		res_str = ft_itoa((long long)va_arg(argptr, long long));	else if (input_symb(com->size, 'l'))		res_str = ft_itoa((long)va_arg(argptr, long));	else if (input_symb(com->size, 'h'))		res_str = ft_itoa((short)va_arg(argptr, int));	else if (input_symb(com->size, '1'))		res_str = ft_itoa((signed char)va_arg(argptr, int));	return (prepare_str(com, res_str));}char	*add_esp_for_c(char *str, t_list *com){	int len_ch;	int width;	char *tmp;	int i;	i = 0;	len_ch = ft_strlen(str);	width = ft_atoi(com->width);	tmp = ft_strnew(width - len_ch);	while (i < (width - len_ch))		tmp[i++] = ' ';	//if (!input_symb(com->flags, '0'))		str = (input_symb(com->flags, '-')) ?			ft_strjoin(str, tmp) : ft_strjoin(tmp, str);	free(tmp);	return (str);}char 	*add_esp_for_c_end(char *str, t_list *com){		int len_ch;	int width;	char *tmp;	int i;	i = 0;	len_ch = ft_strlen(str);	width = ft_atoi(com->width);	tmp = ft_strnew(width - len_ch);	while (i < (width - len_ch))		tmp[i++] = ' ';	str = ft_strjoin(str, tmp);	free(tmp);	return (str);}char 	*add_null_in_c(char *str, t_list *com){	int len_ch;	int w;	char *tmp;	int i;	i = 0;	len_ch = ft_strlen(str);	w = ft_atoi(com->width);	tmp = ft_strnew(w - len_ch);	while (i < (w - len_ch))		tmp[i++] = '0';	str = ft_strjoin(tmp, str);	free(tmp);	return (str);}char	*prepare_str_c(t_list *com, char *str){	if (com->width && !input_symb(com->flags, '0') &&		(ft_atoi(com->width) > ft_strlen(str)))		str = add_esp_for_c(str, com);	else if (com->width && input_symb(com->flags, '0') &&		!input_symb(com->flags, '-') &&		ft_atoi(com->width) > ft_strlen(str))		str = add_null_in_c(str, com);	else if (com->width && input_symb(com->flags, '0') &&		input_symb(com->flags, '-') &&		(ft_atoi(com->width) > ft_strlen(str)))		str = add_esp_for_c_end(str, com);	return (str);}char	*search_sp_c(va_list argptr, t_list *com){	char *res_str;	res_str = ft_strnew(1);	if (com->size == NULL)		res_str[0] = va_arg(argptr, int);	else if (input_symb(com->size, 'l'))		res_str[0] = va_arg(argptr, wint_t);	return (prepare_str_c(com, res_str));}char 	*prepare_str_ex(t_list *com){	char *res_str;		res_str = ft_strnew(1);	res_str[0] = '%';	if (com->width && ft_atoi(com->width) > 1)		res_str = add_esp(res_str, com);	return (res_str);}char 	*prepare_str_s(t_list *com, char *res_str){	char 	*res;	int 	len;	if (com->precision)		len = ft_atoi(com->precision);	res = NULL;	if (com->precision && len < ft_strlen(res_str))	{		res = ft_strnew(len);		ft_strncpy(res, res_str, len);		res_str = res;	}	if (com->width && !input_symb(com->flags, '0') &&		(ft_atoi(com->width) > ft_strlen(res_str)))		res_str = add_esp_for_c(res_str, com);	else if (com->width && input_symb(com->flags, '0') &&		!input_symb(com->flags, '-') &&		ft_atoi(com->width) > ft_strlen(res_str))		res_str = add_null_in_c(res_str, com);	else if (com->width && input_symb(com->flags, '0') &&		input_symb(com->flags, '-') &&		(ft_atoi(com->width) > ft_strlen(res_str)))		res_str = add_esp_for_c_end(res_str, com);	// if (com->width && ft_atoi(com->width) > ft_strlen(res_str))	// 	res_str = add_esp_for_c(res_str, com);	// if (input_symb(com->flags, '0') && !input_symb(com->flags, '-'))	// 	res_str = add_null_in_c(res_str, com);	return (res_str);}char 	*prepare_str_s2(t_list *com, wchar_t *res_str){	// if (com->width && ft_atoi(com->width) > ft_strlen(res_str))	// 	res_str = add_esp(res_str, com);	return ((char *)res_str);}char 	*search_sp_s(va_list argptr, t_list *com){	char *res_str;	wchar_t *res;	res_str = NULL;	res = NULL;	if (com->size == NULL)		res_str = va_arg(argptr, char *);	else if (com->size && input_symb(com->size, 'l'))		res = va_arg(argptr, wchar_t *);	return((res_str) ? prepare_str_s(com, res_str) : prepare_str_s2(com, res));}void	form_string(va_list argptr, char *str, t_list *com){		char ch;	char *res;	ch = com->specificator;	if (ch == 'd' || ch == 'i')		res = search_sp_d(argptr, com);	else if (ch == 'c')	 	res = search_sp_c(argptr, com);	 else if (ch == '%')	 	res = prepare_str_ex(com);	 else if (ch == 's')	 	res = search_sp_s(argptr, com);	ft_putstr(res);}void read_com_str(t_list *com, char *str){	set_list_null(com);	search_specificator(com, str);	search_flags(com, str);	search_width(com, str);	search_precision(com, str);	search_size(com, str);}void	ft_printf(char *str, ...){	va_list argptr;	t_list com;	int i;	char *head;	i = 0;	head = str;	va_start(argptr, str);	while (str[i] != '\0')	{		if (str[i] == '%')		{			read_com_str(&com, &str[++i]);			form_string(argptr, head, &com);			while (is_input_spec(str[++i - 1]) == -1)				;		}		ft_putchar(str[i]);		i++;	}	va_end(argptr);}int		main(void){//	t_list test;//	read_com_str(&test, "0.1+hhh-#.ll6l0 0hd");	//	printf("prec=%s\n", test.size);	wint_t i;	int n;	char ch = 'F';	char str[] = "TEST 012345 TEST";	i = 80;	n = -71;	//    printf("Eto idend D = %010d is N\n", i);	// ft_printf("Eto idend D = %010d is N\n", i);	//    printf("Eto idend D = %010d is N\n", n);	// ft_printf("Eto idend D = %010d is N\n", n);		   printf("Eto idend ch = %040s is N\n", "TEST 012345 TEST");	ft_printf("Eto idend ch = %040s is N\n", "TEST 012345 TEST");	//    printf("Eto idend ch = %-010%c is N\n", ch);	// ft_printf("Eto idend ch = %-010%c is N\n", ch);	return 0; }